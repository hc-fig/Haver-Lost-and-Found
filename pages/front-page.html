<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <!-- Optional theme -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
        <!-- Custom styles for this template -->
        <link href="css/style.css" type="text/css" rel="stylesheet">
        
        <script>
            $(document).ready(function(){
                
                // Handles search requests initiated by clicking the "search" button
                $("#search").click(function(){
                    
                    // Takes the current contents of the search_query box
                    var search = $("#search_query").val();
                    
                    // Sends the info to the server, which will give us an array of matched posts
                    $.post("/search", {search_query: search}, function(result){
                        $(".search_results").empty();
                        
                        // Formats and displays the data appropriately
                        $(".search_results").append("<br><br>");
                        $(".search_results").append("<div class='row'>");
                        var color;
                        for (var i = 0; i < result.posts.length; i++) {
                            
                            color = "red";
                            if (i %2 == 0){
                                color = "black";
                            }
                            
                            
    
                            $(".search_results").append(
                                "<div class='col-md-4' style='border:10px double " +color +"';"  + ">" + 
                                "<h2> Item " + (i+1) + "</h2>" +
                                "<p>" + "Type: " + result.posts[i].postType + "</p>" + 
                                "<p>" + "Username: " + result.posts[i].username + "</p>" + 
                                "<p>" + "Item Name: " + result.posts[i].item_name + "</p>" + 
                                "<p>" + "Description: " + result.posts[i].description + "</p>" +
                                "<p>" + "Date added: " + formatDate(new Date(result.posts[i].date)) + "</p>" + 
                                "<br>" +
                                "</div>"
                                
                                
                            );
                        $(".search_results").append("</div>");    
                            
                        }
                        if (results.posts.length == 0){
                            $(".search_results").append(
                            "<h2>Sorry, we have no results for that search</h2>" + 
                            "<p>Please try checking to make sure you have not mispelled your search. Also, try using a synonym such as jacket instead of coat.</p>"
                            );
                        }
                        
                    });
                });
                
                // Link to the "browse lost" page
                $("#browseLost").click(function(){
                    window.location.href = "/browseLost";
                });
                
                // Link to the "browse found" page
                $("#browseFound").click(function(){
                    window.location.href = "/browseFound";
                });
            });
            
            // Helper function for formatting dates using slash notation
            function formatDate(d) {  // d should be a Date object. Returns a string
                return d.getMonth() + 1 + "/" + d.getDay() + 1 + "/" + d.getFullYear();
            }
        </script>
        
    </head>
    <body>
        
        <div class = container>
            
            <!--############## Title at top as well as the selection bar ##############-->        
        
            <div class="masthead">
                <h1> Haver Lost and Found</h1>
                
                <nav>
                    <ul class="nav nav-justified">
                        <li class="active"><a href="">Home</a></li>
                        <li><a href="#">Submit a New Post</a></li>
                        <li><a href="browseLost">Lost Item List</a></li>
                        <li><a href="browseFound">Found Item List</a></li>
                        
                        
                    </ul>
                </nav>
            </div>
            <br><br>
            <div class="jumbotron">
                <h2>Welcome</h2>
                <p-2>This is Haverford's Lost and Found Website! Text as placeholder for an explanation: Text text text ksdjv kdfj sdk dkjf jkdfj dkjdk jfdkjd slsdjf lsdkjf lkdfj dlkfj dlfj dlfjd ldfj ldfj dlfj dlkfj dlfj dlfj dlf jdlfj dlkfj dlkf jdlk jsldjs lsdjf dlsfj dslj fdlkj fjlsdj fldj fldkf jdlkj dl</p-2>
            </div>
            
            
            <!--############## Displays search field ##############-->
            <h3>Search for an item:</h3>
            <input type="text" id="search_query" name="search_query" placeholder="Search for an item..." />
            <button id="search">Search</button>
        </div>
        
        <!--############## Displays search results ##############-->
        <div class = container >
            <div class="search_results">
            <br> <!-- this will be replaced by a post display when the user clicks the search button-->
            </div>
        </div>
        
        <!--############## Displays new post submission form ##############-->
        <div class = container>
            <br><br>
            <h3>Submit a new lost or found post:</h3>
            <form action="" method="post" enctype="multipart/form-data">
                <fieldset>
                    <input type="radio" value="Lost" name="postType" checked="checked">Submitting a lost post
                    <br>
                    <input type="radio" value="Found" name="postType">Submitting a found post
                    <br><br>
                    <label for="username">Username:</label>
                    <br>
                    <input type="text" id="username" name="username" placeholder="Enter your username" />
                    <br><br>
                    <label for="item_name">Item name:</label>
                    <br>
                    <input type="text" id="item_name" name="item_name" placeholder="What did you lose/find?" />
                    <br><br>
                    <label for="description">Item description:</label>
                    <br>
                    <textarea id="description" name="description" placeholder="Describe the item" rows=5 cols=40></textarea>
                    <br><br>
                    <input type="submit" value="Submit new lost and found post!" />
                </fieldset>
            </form>
            
        <footer class="footer">
            <p>Created by Pablo Thiel and Kadan Lottick</p>
        </footer>    
        
        </div>
        
        
    </body>
</html>